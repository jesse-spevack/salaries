<div data-controller="graduation profile"
  data-graduation-show-class="opacity-100"
  data-graduation-hide-class="opacity-0"
  data-graduation-highlighted-class="text-white"
  data-graduation-background-highlighted-class="bg-indigo-600"
  data-graduation-not-highlighted-class="text-gray-900"
  data-graduation-selected-item-font-class="font-semibold"
  data-graduation-not-selected-item-font-class="font-normal"
  data-graduation-checked-class="text-white"
  data-graduation-unchecked-class="text-indigo-600"
  data-graduation-hidden-class="hidden"
  tabindex="1"
  data-action="focusout->graduation#hideList"
  data-graduation-graduation-year-value="<%= @profile.graduation_year %>"
  data-graduation-profile-id-value="<%= @profile.id %>"
>
  <div class="my-5 border-t border-gray-200">
    <dl data-graduation-target="show" 
      class="divide-y divide-gray-200">
      <div class="py-4 sm:py-5 sm:grid sm:grid-cols-3 sm:gap-4">
        <dt class="text-sm font-medium text-gray-500">
          Graduation year
        </dt>
        <dd class="mt-1 flex text-sm text-gray-900 sm:mt-0 sm:col-span-2">
          <span data-graduation-target="graduationYearText" class="flex-grow">
            <%= @profile.graduation_year  %>
          </span>
          <span class="ml-4flex-shrink-0">
            <button data-action="graduation#showForm"
              type="button" 
              class="bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
              Update
            </button>
          </span>
        </dd>
      </div>
    </dl>

    <div data-graduation-target="form" class="hidden w-full max-w-xs my-5">
      <label id="listbox-label" class="block text-sm font-medium text-gray-500">
        Graduation year
      </label>
      <div class="mt-1 relative">
        <button data-action="graduation#showList"
          data-graduation-target="select"
          type="button"
          aria-haspopup="listbox"
          aria-expanded="true"
          aria-labelledby="listbox-label"
          class="bg-white relative w-full border border-gray-300 rounded-md shadow-sm pl-3 pr-10 py-2 text-left cursor-default focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
        >
          <span data-graduation-target="graduationYearText"
            class="block truncate">
            <%= @profile.graduation_year || "Select Graduation Year" %>
          </span>
          <span class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
            <!-- Heroicon name: selector -->
            <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
              <path fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
          </span>
        </button>

        <!--
          Select popover, show/hide based on select state.

          Entering: ""
            From: ""
            To: ""
          Leaving: "transition ease-in duration-100"
            From: "opacity-100"
            To: "opacity-0"
        -->
        <div data-graduation-target="list" 
          class="opacity-0 absolute mt-1 w-full rounded-md bg-white shadow-lg"
        >
          <ul tabindex="-1" role="listbox" aria-labelledby="listbox-label" aria-activedescendant="listbox-item-3" class="max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm">
              <!--
                Select option, manage highlight styles based on mouseenter/mouseleave and keyboard navigation.

                Highlighted: "text-white bg-indigo-600", Not Highlighted: "text-gray-900"
              -->
            <% Profile::VALID_GRADUATION_YEARS.each do |year| %>
              <li 
                data-graduation-target="item"
                data-action="click->graduation#selectGraduationYear mouseenter->graduation#highlight mouseleave->graduation#unhighlight"
                id="listbox-option-0" role="option" class="text-gray-900 cursor-default select-none relative py-2 pl-3 pr-9"
              >
                <!-- Selected: "font-semibold", Not Selected: "font-normal" -->
                <span class="font-normal block truncate"
                  data-graduation-target="year"
                  data-action="selected->"
                >
                  <%= year %>
                </span>

                <!--
                  Checkmark, only display for selected option.

                  Highlighted: "text-white", Not Highlighted: "text-indigo-600"
                -->
                <span data-graduation-target="check"
                  class="text-indigo-600 absolute inset-y-0 right-0 flex items-center pr-4">
                  <!-- Heroicon name: check -->
                  <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                  </svg>
                </span>
              </li>
            <% end %>
          </ul>
        </div>
      </div>    
    </div>
  </div>
</div>
